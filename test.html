<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Координатные Плоскости</title>
    <style>
        table {
            border-collapse: collapse;
            margin-top: 20px;
            margin-right: 20px;
            float: left;
        }
        td, th {
            border: 1px solid black;
            width: 30px;
            height: 30px;
            text-align: center;
        }
        th {
            background-color: #f0f0f0;
        }
        .axis {
            background-color: #e0e0e0;
        }
        .clear {
            clear: both;
        }
    </style>
</head>
<body>

<h1>Координатные Плоскости</h1>
<div id="coordinate-planes"></div>

<script type="module">
import { GaloisField } from './galoisField.js';
function createMultipleTables(n, data) {
    const dimensions = data.length > 0 ? data[0].coords.length : 2; // Количество измерений
    const container = document.getElementById('coordinate-planes');

    // Получаем максимальные значения для всех координат кроме X и Y
    let maxCoords = Array(n).fill(0);

    // Определяем максимальные значения для каждой координаты после x и y
    data.forEach(item => {
        for (let i = 2; i < dimensions; i++) {
            maxCoords[i - 2] = maxCoords[i - 2] >= item.coords[i] ? maxCoords[i - 2] : item.coords[i];
            // maxCoords[i - 2] = Math.max(maxCoords[i - 2], Number(item.coords[i]));
        }
    });

    // Для каждой комбинации координат за пределами x и y создаём отдельную таблицу
    const createTableForCoords = (remainingCoords, currentLevel) => {
        if (currentLevel >= maxCoords.length) {
            // Создаем таблицу для фиксированного уровня координат
            const table = document.createElement('table');
            const caption = document.createElement('caption');
            caption.innerHTML = `( ${remainingCoords.map((val, index) => `${val}`).join(', ')} )`;
            table.appendChild(caption);
    
            for (let i = n; i >= 0; i--) {
                const row = document.createElement('tr');
    
                for (let j = 0n; j <= n; j++) {
                    const cell = document.createElement(i == 0 || j == 0 ? 'th' : 'td');
                    // const cell = document.createElement('td');
    
                    if (i == 0 && j == 0) {
                        cell.innerHTML = ' ';
                    } else if (i == 0) {
                        // Ось x
                        cell.innerHTML = j - 1n;
                        cell.classList.add('axis');
                    } else if (j == 0) {
                        // Ось y
                        cell.innerHTML = i - 1n;
                        cell.classList.add('axis');
                    } else {
                        // Ищем объект с координатами x, y и фиксированными оставшимися координатами
                        const obj = data.find(item => {
                            const [x, y, ...rest] = item.coords;
                            return x == i - 1n && y == j - 1n && rest.every((coord, index) => coord == remainingCoords[index]);
                        });
                        cell.innerHTML = obj ? obj.number : '∞';
                    }
    
                    row.appendChild(cell);
                }
    
                table.appendChild(row);
            }

            container.appendChild(table);
        } else {
            // Рекурсивно создаём таблицы для всех значений текущей координаты
            for (let i = 0; i <= maxCoords[currentLevel]; i++) {
                createTableForCoords([...remainingCoords, i], currentLevel + 1);
            }
        }
    };

    // Запуск генерации таблиц для всех возможных комбинаций координат за пределами x и y
    createTableForCoords([], 0);
}

// Пример использования
const p = 3n;
const n = 3n;
const A = [
    [0n, 1n, 0n,],
    [0n, 0n, 1n,],
    [2n, 0n, 1n,],
];
const B = [
    [0n, 1n],
    [2n, 2n],
];
let field = new GaloisField(p, n)
const data = field.buildFromMatrix(A);

createMultipleTables(p, data);
</script>

</body>
</html>
